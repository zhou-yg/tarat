/**
 * @tips: this file is generated by tarat. do not modified this file
 */
import * as React from 'react'
import * as ReactDOM from 'react-dom/client'
import {
  Routes,
  Route,
  BrowserRouter,
} from "react-router-dom"
import { preset } from '@polymita/signal-model'
import {
  RenderDriver,
  setHookAdaptor,
  registerModelIndexes } from '@polymita/connect'

<% if (rootPath) { %>
import <%= rootName %> from '<%= rootPath %>'
<% } %>

<%- imports %>

registerModelIndexes(<%- modelIndexes %>)

preset.clientRuntime()
const TopContext = setHookAdaptor(React as any)

function _TaratRootApplication({
  location
}) {
  const driver = new RenderDriver();
  driver.fromContextMap(window.hookContextMap);
  driver.switchToClientConsumeMode();
  
  return (
    <TopContext.Provider value={driver}>
      <BrowserRouter>
        <%- rootStart %>
        <Routes>
          <%- routes %>
        </Routes>  
        <%- rootEnd %>
      </BrowserRouter>
    </TopContext.Provider>
  );
}

render(_TaratRootApplication)

function render (f) {
  const ele = React.createElement(f)
  const app = ReactDOM.createRoot(document.getElementById('app'))
  app.render(ele)
}
